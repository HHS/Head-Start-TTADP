{"type":"auditAdvisory","data":{"resolution":{"id":1102341,"path":"tsx>esbuild","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"0.18.20","paths":["tsx>esbuild"]}],"found_by":null,"deleted":null,"references":"- https://github.com/evanw/esbuild/security/advisories/GHSA-67mh-4wv8-2f99\n- https://github.com/evanw/esbuild/commit/de85afd65edec9ebc44a11e245fd9e9a2e99760d\n- https://github.com/advisories/GHSA-67mh-4wv8-2f99","created":"2025-02-10T17:48:07.000Z","id":1102341,"npm_advisory_id":null,"overview":"### Summary\n\nesbuild allows any websites to send any request to the development server and read the response due to default CORS settings.\n\n### Details\n\nesbuild sets `Access-Control-Allow-Origin: *` header to all requests, including the SSE connection, which allows any websites to send any request to the development server and read the response.\n\nhttps://github.com/evanw/esbuild/blob/df815ac27b84f8b34374c9182a93c94718f8a630/pkg/api/serve_other.go#L121\nhttps://github.com/evanw/esbuild/blob/df815ac27b84f8b34374c9182a93c94718f8a630/pkg/api/serve_other.go#L363\n\n**Attack scenario**:\n\n1. The attacker serves a malicious web page (`http://malicious.example.com`).\n1. The user accesses the malicious web page.\n1. The attacker sends a `fetch('http://127.0.0.1:8000/main.js')` request by JS in that malicious web page. This request is normally blocked by same-origin policy, but that's not the case for the reasons above.\n1. The attacker gets the content of `http://127.0.0.1:8000/main.js`.\n\nIn this scenario, I assumed that the attacker knows the URL of the bundle output file name. But the attacker can also get that information by\n\n- Fetching `/index.html`: normally you have a script tag here\n- Fetching `/assets`: it's common to have a `assets` directory when you have JS files and CSS files in a different directory and the directory listing feature tells the attacker the list of files\n- Connecting `/esbuild` SSE endpoint: the SSE endpoint sends the URL path of the changed files when the file is changed (`new EventSource('/esbuild').addEventListener('change', e => console.log(e.type, e.data))`)\n- Fetching URLs in the known file: once the attacker knows one file, the attacker can know the URLs imported from that file\n\nThe scenario above fetches the compiled content, but if the victim has the source map option enabled, the attacker can also get the non-compiled content by fetching the source map file.\n\n### PoC\n\n1. Download [reproduction.zip](https://github.com/user-attachments/files/18561484/reproduction.zip)\n2. Extract it and move to that directory\n1. Run `npm i`\n1. Run `npm run watch`\n1. Run `fetch('http://127.0.0.1:8000/app.js').then(r => r.text()).then(content => console.log(content))` in a different website's dev tools.\n\n![image](https://github.com/user-attachments/assets/08fc2e4d-e1ec-44ca-b0ea-78a73c3c40e9)\n\n### Impact\n\nUsers using the serve feature may get the source code stolen by malicious websites.","reported_by":null,"title":"esbuild enables any website to send any requests to the development server and read the response","metadata":null,"cves":[],"access":"public","severity":"moderate","module_name":"esbuild","vulnerable_versions":"<=0.24.2","github_advisory_id":"GHSA-67mh-4wv8-2f99","recommendation":"Upgrade to version 0.25.0 or later","patched_versions":">=0.25.0","updated":"2025-02-10T17:48:08.000Z","cvss":{"score":5.3,"vectorString":"CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N"},"cwe":["CWE-346"],"url":"https://github.com/advisories/GHSA-67mh-4wv8-2f99"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1103613,"path":"puppeteer>tar-fs","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"2.1.1","paths":["puppeteer>tar-fs"]}],"found_by":null,"deleted":null,"references":"- https://nvd.nist.gov/vuln/detail/CVE-2024-12905\n- https://github.com/mafintosh/tar-fs/commit/a1dd7e7c7f4b4a8bd2ab60f513baca573b44e2ed\n- https://github.com/advisories/GHSA-pq67-2wwv-3xjx","created":"2025-03-27T18:31:28.000Z","id":1103613,"npm_advisory_id":null,"overview":"An Improper Link Resolution Before File Access (\"Link Following\") and Improper Limitation of a Pathname to a Restricted Directory (\"Path Traversal\"). This vulnerability occurs when extracting a maliciously crafted tar file, which can result in unauthorized file writes or overwrites outside the intended extraction directory. The issue is associated with index.js in the tar-fs package.\n\nThis issue affects tar-fs: from 0.0.0 before 1.16.4, from 2.0.0 before 2.1.2, from 3.0.0 before 3.0.7.","reported_by":null,"title":"tar-fs Vulnerable to Link Following and Path Traversal via Extracting a Crafted tar File","metadata":null,"cves":["CVE-2024-12905"],"access":"public","severity":"high","module_name":"tar-fs","vulnerable_versions":">=2.0.0 <2.1.2","github_advisory_id":"GHSA-pq67-2wwv-3xjx","recommendation":"Upgrade to version 2.1.2 or later","patched_versions":">=2.1.2","updated":"2025-03-28T22:11:43.000Z","cvss":{"score":7.5,"vectorString":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"},"cwe":["CWE-22"],"url":"https://github.com/advisories/GHSA-pq67-2wwv-3xjx"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1094902,"path":"@axe-core/cli>chromedriver","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"109.0.0","paths":["@axe-core/cli>chromedriver"]}],"found_by":null,"deleted":null,"references":"- https://nvd.nist.gov/vuln/detail/CVE-2023-26156\n- https://github.com/giggio/node-chromedriver/commit/de961e34e023afcf4fa5c0faeeec69aaa6c3c815\n- https://gist.github.com/mcoimbra/47b1da554a80795c45126d51e41b2b18\n- https://security.snyk.io/vuln/SNYK-JS-CHROMEDRIVER-6049539\n- https://github.com/advisories/GHSA-hm92-vgmw-qfmx","created":"2023-11-09T06:30:28.000Z","id":1094902,"npm_advisory_id":null,"overview":"Versions of the package chromedriver before 119.0.1 are vulnerable to Command Injection when setting the chromedriver.path to an arbitrary system binary. This could lead to unauthorized access and potentially malicious actions on the host system.\n\n**Note:**\n\nAn attacker must have access to the system running the vulnerable chromedriver library to exploit it. The success of exploitation also depends on the permissions and privileges of the process running chromedriver. ","reported_by":null,"title":"chromedriver Command Injection vulnerability","metadata":null,"cves":["CVE-2023-26156"],"access":"public","severity":"moderate","module_name":"chromedriver","vulnerable_versions":"<119.0.1","github_advisory_id":"GHSA-hm92-vgmw-qfmx","recommendation":"Upgrade to version 119.0.1 or later","patched_versions":">=119.0.1","updated":"2023-11-17T22:12:01.000Z","cvss":{"score":5.6,"vectorString":"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L"},"cwe":["CWE-78"],"url":"https://github.com/advisories/GHSA-hm92-vgmw-qfmx"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1102259,"path":"redoc-cli>redoc>dompurify","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"2.5.8","paths":["redoc-cli>redoc>dompurify"]}],"found_by":null,"deleted":null,"references":"- https://nvd.nist.gov/vuln/detail/CVE-2025-26791\n- https://github.com/cure53/DOMPurify/commit/d18ffcb554e0001748865da03ac75dd7829f0f02\n- https://ensy.zip/posts/dompurify-323-bypass\n- https://github.com/cure53/DOMPurify/releases/tag/3.2.4\n- https://nsysean.github.io/posts/dompurify-323-bypass\n- https://github.com/advisories/GHSA-vhxf-7vqr-mrjg","created":"2025-02-14T09:31:22.000Z","id":1102259,"npm_advisory_id":null,"overview":"DOMPurify before 3.2.4 has an incorrect template literal regular expression, sometimes leading to mutation cross-site scripting (mXSS).","reported_by":null,"title":"DOMPurify allows Cross-site Scripting (XSS)","metadata":null,"cves":["CVE-2025-26791"],"access":"public","severity":"moderate","module_name":"dompurify","vulnerable_versions":"<3.2.4","github_advisory_id":"GHSA-vhxf-7vqr-mrjg","recommendation":"Upgrade to version 3.2.4 or later","patched_versions":">=3.2.4","updated":"2025-02-14T18:05:09.000Z","cvss":{"score":4.5,"vectorString":"CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N"},"cwe":["CWE-79"],"url":"https://github.com/advisories/GHSA-vhxf-7vqr-mrjg"}}}
{"type":"auditAdvisory","data":{"resolution":{"id":1103634,"path":"redoc-cli>redoc","dev":false,"optional":false,"bundled":false},"advisory":{"findings":[{"version":"2.0.0","paths":["redoc-cli>redoc"]}],"found_by":null,"deleted":null,"references":"- https://nvd.nist.gov/vuln/detail/CVE-2024-57083\n- https://github.com/Redocly/redoc/issues/2499\n- https://github.com/Redocly/redoc/pull/2638\n- https://github.com/advisories/GHSA-9rhg-254w-fh9x","created":"2025-03-28T21:30:47.000Z","id":1103634,"npm_advisory_id":null,"overview":"A prototype pollution in the component Module.mergeObjects (redoc/bundles/redoc.lib.js:2) of redoc <= 2.2.0 allows attackers to cause a Denial of Service (DoS) via supplying a crafted payload.","reported_by":null,"title":"Redoc Prototype Pollution via `Module.mergeObjects` Component","metadata":null,"cves":["CVE-2024-57083"],"access":"public","severity":"high","module_name":"redoc","vulnerable_versions":"<2.4.0","github_advisory_id":"GHSA-9rhg-254w-fh9x","recommendation":"Upgrade to version 2.4.0 or later","patched_versions":">=2.4.0","updated":"2025-03-31T15:58:52.000Z","cvss":{"score":0,"vectorString":null},"cwe":["CWE-1321"],"url":"https://github.com/advisories/GHSA-9rhg-254w-fh9x"}}}
